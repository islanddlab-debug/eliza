<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Eliza's English Playground</title>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#FF9F1C">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ¦</text></svg>">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ¦</text></svg>">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #FF9F1C;
            --secondary: #2EC4B6;
            --accent: #FFBF69;
            --phonics: #FF99C8;
            --love: #FF5252;
            --bg: #F4F7F6;
            --card-bg: #FFFFFF;
            --text-main: #2D3436;
            --side-gap: 20px;
        }
        
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body { 
            font-family: 'Fredoka', 'Microsoft JhengHei', sans-serif; 
            background: var(--bg); 
            margin: 0; 
            padding-bottom: 80px; 
            padding-top: env(safe-area-inset-top);
            color: var(--text-main);
            overflow-x: hidden;
            font-size: 18px;
            overscroll-behavior-y: none;
        }
        
        /* Header Auto-Hide */
        .header-area {
            position: fixed; top: 0; left: 0; z-index: 100;
            background: rgba(255,255,255,0.98);
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            backdrop-filter: blur(10px);
            width: 100%;
            transition: transform 0.3s ease;
            padding-top: env(safe-area-inset-top);
        }
        .header-area.header-hidden { transform: translateY(-100%); }

        .header-inner {
            max-width: 1200px; margin: 0 auto;
            padding: 10px var(--side-gap) 0 var(--side-gap);
        }

        /* å¢åŠ å¢Šç‰‡é«˜åº¦ï¼Œè§£æ±ºæ‰‹æ©Ÿç‰ˆæŒ‘æˆ°æ¨¡å¼è¢«æ“‹ä½çš„å•é¡Œ */
        .spacer { height: 160px; }

        .top-row {
            display: flex; justify-content: space-between; align-items: center;
            gap: 15px; margin-bottom: 10px;
        }
        
        h1 { 
            margin: 0; color: var(--primary); 
            font-size: 1.6rem; font-weight: 600;
            display: flex; align-items: center; gap: 8px; 
            white-space: nowrap; letter-spacing: 0.5px;
        }

        .search-box { flex-grow: 1; position: relative; max-width: 400px; }
        .search-input {
            width: 100%; padding: 12px 18px; border-radius: 25px;
            border: 2px solid #eee; font-size: 1rem; outline: none;
            transition: 0.3s; background: #f9f9f9; appearance: none;
            font-family: 'Fredoka', sans-serif;
        }
        .search-input:focus { border-color: var(--secondary); background: white; }

        .tools-row {
            display: flex; gap: 8px; overflow-x: auto; align-items: center;
            padding-bottom: 10px; scrollbar-width: none;
        }
        .tools-row::-webkit-scrollbar { display: none; }

        .tool-btn {
            background: #f0f0f0; border: none; color: #888;
            padding: 10px 16px; border-radius: 25px; cursor: pointer;
            font-size: 0.95rem; display: flex; align-items: center; gap: 6px;
            white-space: nowrap; font-weight: 600; transition: 0.2s; flex-shrink: 0;
            font-family: 'Fredoka', sans-serif;
        }
        .tool-btn:active { transform: scale(0.95); }

        #btnQuiz.active { background: var(--primary); color: white; box-shadow: 0 4px 10px rgba(255, 159, 28, 0.3); }
        #btnFocus { background: #E3F2FD; color: #1565C0; }
        .lang-btn.active { background: #E8F5E9; color: #2E7D32; border: 1px solid #4CAF50; }

        .nav-scroller { 
            overflow-x: auto; white-space: nowrap; 
            padding: 5px var(--side-gap) 15px var(--side-gap);
            -webkit-overflow-scrolling: touch; scrollbar-width: none;
            margin-left: calc(var(--side-gap) * -1); margin-right: calc(var(--side-gap) * -1);
            padding-left: var(--side-gap);
        }
        .nav-scroller::-webkit-scrollbar { display: none; }
        
        .room-tab {
            display: inline-block; padding: 10px 20px; margin-right: 8px;
            background: white; border-radius: 25px; cursor: pointer;
            border: 2px solid #eee; color: #666; font-weight: 600; font-size: 1rem;
            transition: all 0.2s; font-family: 'Fredoka', sans-serif;
        }
        .room-tab.active { background: var(--secondary); color: white; border-color: var(--secondary); transform: scale(1.05); }
        .room-tab.fav-tab { border-color: var(--love); color: var(--love); }
        .room-tab.fav-tab.active { background: var(--love); color: white; }
        .room-tab.phonics-tab { border-color: var(--phonics); color: var(--phonics); }
        .room-tab.phonics-tab.active { background: var(--phonics); color: white; border-color: var(--phonics); }

        .main-container { max-width: 1200px; margin: 0 auto; padding: 0 var(--side-gap); }

        #quizArea {
            display: none; background: var(--accent); padding: 15px;
            text-align: center; margin: 15px 0; border-radius: 15px;
            box-shadow: 0 4px 0 #e5ac5e; animation: bounceIn 0.5s;
            margin-bottom: 20px; /* å¢åŠ åº•éƒ¨è·é›¢ */
        }
        @keyframes bounceIn { 0% {transform: scale(0.8); opacity:0;} 70% {transform: scale(1.05);} 100% {transform: scale(1); opacity:1;} }
        #quizQuestion { font-size: 1.5rem; font-weight: 600; color: #444; }

        .grid {
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); 
            gap: 20px; padding-bottom: 40px;
        }
        
        @media (max-width: 480px) {
            .grid { grid-template-columns: repeat(2, 1fr); gap: 12px; }
            .top-row { flex-direction: column; align-items: stretch; }
            .search-box { max-width: 100%; }
            h1 { justify-content: center; margin-bottom: 5px; }
            /* æ‰‹æ©Ÿç‰ˆå¢Šç‰‡åŠ é«˜ï¼Œé¿å…æ“‹ä½æŒ‘æˆ°æ¨¡å¼ */
            .spacer { height: 220px; } 
        }

        .card {
            background: var(--card-bg); border-radius: 20px; text-align: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05); cursor: pointer;
            transition: transform 0.2s; border: 3px solid transparent;
            position: relative; overflow: hidden; user-select: none;
            aspect-ratio: 1 / 1.15; display: flex; flex-direction: column;
        }
        .card:active { transform: scale(0.98); }
        
        /* è¦å‰‡æ¨™ç±¤å¾®èª¿ï¼šå­—å°ä¸€é»ï¼Œé«˜åº¦çª„ä¸€é»ï¼Œé¿å…æ“ å£“å…§å®¹ */
        .rule-tag {
            font-size: 0.8rem; font-weight: 600; padding: 4px 0;
            color: #fff; background: rgba(0,0,0,0.1); width: 100%; letter-spacing: 1px;
        }

        .card-img {
            flex-grow: 1; display: flex; align-items: center; justify-content: center;
            font-size: 4.2rem; /* Emoji ç¨å¾®ç¸®å°ä¸€é»é» */
            background: linear-gradient(180deg, #fafafa 0%, #fff 100%);
            width: 100%; transition: background 0.3s;
        }
        .card-body { padding: 10px 5px; border-top: 1px solid rgba(0,0,0,0.05); background: #fff; }
        
        /* å–®å­—å­—é«”å¤§å°å¾®èª¿ */
        .en-word { font-size: 1.3rem; font-weight: 600; color: #333; display: block; margin-bottom: 2px; transition: opacity 0.3s; line-height: 1.2;}
        .zh-word { font-size: 1rem; color: #888; font-weight: 500; transition: opacity 0.3s; font-family: 'Microsoft JhengHei', sans-serif; }

        .phonics-card .en-word { font-size: 1.5rem; color: #333; } 
        .flag-card .card-img img { width: 100%; height: 100%; object-fit: cover; }
        
        .hide-zh .zh-word { opacity: 0; }
        .hide-en .en-word { opacity: 0; }
        .hide-text .zh-word, .hide-text .en-word { opacity: 0; }
        
        .card.correct { border-color: #4CAF50; transform: scale(1.05) !important; z-index: 10; box-shadow: 0 0 15px #4CAF50; }
        .card.wrong { border-color: #F44336; opacity: 0.6; animation: shake 0.4s; }
        @keyframes shake { 0%, 100% {transform: translateX(0);} 25% {transform: translateX(-5px);} 75% {transform: translateX(5px);} }

        /* Focus Mode & Modal */
        #focusOverlay, .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(244, 247, 246, 0.95); z-index: 500; display: none;
            flex-direction: column; align-items: center; justify-content: center;
        }
        .modal-overlay { background: rgba(0,0,0,0.85); z-index: 999; }

        .focus-card {
            background: white; width: 85%; max-width: 400px; aspect-ratio: 3/4;
            border-radius: 35px; box-shadow: 0 15px 50px rgba(0,0,0,0.15);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            padding: 20px; border: 8px solid white; transition: 0.3s;
            position: relative; overflow: hidden;
        }
        .focus-card-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; opacity: 0.1; }
        .focus-content-layer { z-index: 1; text-align: center; width: 100%; display: flex; flex-direction: column; align-items: center; }

        .focus-rule { font-size: 1.6rem; color: #888; margin-bottom: 10px; font-weight: bold; letter-spacing: 2px; }
        .focus-icon { font-size: 8rem; margin-bottom: 15px; }
        .focus-en { font-size: 3.2rem; font-weight: 600; color: var(--text-main); margin-bottom: 5px; line-height: 1.1; transition: opacity 0.3s; }
        .focus-zh { font-size: 1.6rem; color: #666; margin-bottom: 20px; transition: opacity 0.3s; }
        .focus-flag-img { width: 90%; height: auto; border-radius: 15px; margin-bottom: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }

        /* æ„›å¿ƒæŒ‰éˆ•æ¨£å¼ (ç§»åˆ°åº•éƒ¨æ§åˆ¶åˆ—ï¼Œçµ±ä¸€æ¨£å¼) */
        .fav-btn {
            width: 45px; height: 45px; border-radius: 50%;
            background: white; border: 2px solid #eee; color: #ddd;
            font-size: 1.5rem; cursor: pointer; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1); transition: 0.2s;
        }
        .fav-btn:active { transform: scale(0.9); }
        .fav-btn.active { color: var(--love); border-color: var(--love); background: #FFF0F0; }

        .focus-controls { 
            display: flex; gap: 20px; align-items: center; justify-content: center; margin-top: 10px; 
            width: 100%;
        }

        .snail-btn {
            width: 45px; height: 45px; border-radius: 50%;
            background: #E3F2FD; border: none; color: #1565C0;
            font-size: 1.5rem; cursor: pointer; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1); transition: 0.2s;
        }
        .snail-btn:active { transform: scale(0.9); }

        .focus-mic-container { position: relative; width: 70px; height: 70px; display: flex; align-items: center; justify-content: center; }
        .focus-mic-btn {
            width: 60px; height: 60px; border-radius: 50%;
            background: white; border: 2px solid #f0f0f0; color: var(--primary);
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            font-size: 2rem; cursor: pointer; z-index: 2;
            display: flex; align-items: center; justify-content: center;
            transition: all 0.2s;
        }
        .focus-mic-btn:active { transform: scale(0.95); background: #f9f9f9; }

        .focus-progress-ring { position: absolute; top: 0; left: 0; width: 70px; height: 70px; transform: rotate(-90deg); z-index: 1; pointer-events: none; }
        .focus-progress-ring__circle { stroke-dasharray: 201; stroke-dashoffset: 201; transition: stroke-dashoffset 0s; }
        
        .recording .focus-mic-btn { background: #FF5252; color: white; border-color: #FF5252; animation: pulse-red 1s infinite; }
        .recording .focus-progress-ring__circle { stroke-dashoffset: 0; transition: stroke-dashoffset 2s linear; }
        @keyframes pulse-red { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

        .focus-nav-btn {
            position: absolute; top: 50%; transform: translateY(-50%);
            background: white; border: none; width: 50px; height: 50px;
            border-radius: 50%; box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            font-size: 1.5rem; color: var(--secondary); cursor: pointer; z-index: 501;
        }
        .prev-btn { left: 15px; } .next-btn { right: 15px; }
        @media (max-width: 480px) {
            .focus-nav-btn { top: 88%; background: rgba(255,255,255,0.9); }
            .prev-btn { left: 15%; } .next-btn { right: 15%; }
        }
        
        /* é—œé–‰æŒ‰éˆ• (å¤§å‰å‰ï¼Œå³ä¸Šè§’) */
        .close-overlay-btn {
            position: absolute; top: 20px; right: 20px;
            width: 50px; height: 50px; border-radius: 50%; 
            background: rgba(255,255,255,0.8); backdrop-filter: blur(5px);
            border: none; font-size: 1.8rem; font-weight: bold; 
            cursor: pointer; color: #555; z-index: 600;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            display: flex; align-items: center; justify-content: center;
        }
        .close-overlay-btn:active { transform: scale(0.9); }

        .modal-content {
            background: white; padding: 20px; border-radius: 25px;
            text-align: center; width: 90%; max-width: 500px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.4); animation: popIn 0.3s ease;
        }
        @keyframes popIn { from {transform: scale(0.9); opacity: 0;} to {transform: scale(1); opacity: 1;} }
        
        .modal-img-container {
            width: 100%; height: 300px; background: #f0f0f0;
            border-radius: 15px; margin-bottom: 15px; overflow: hidden;
            display: flex; align-items: center; justify-content: center; position: relative;
        }
        .modal-img { width: 100%; height: 100%; object-fit: contain; display: none; background: #fff; }
        .modal-loading { font-size: 1.1rem; color: #888; font-weight: bold; }
        .modal-word { font-size: 2rem; color: var(--primary); font-weight: 800; display: block; margin-bottom: 5px; }
        .modal-zh { font-size: 1.2rem; color: #666; margin-bottom: 15px; display: block; }
        
        .source-tag { position: absolute; bottom: 8px; right: 8px; font-size: 0.7rem; background: rgba(0,0,0,0.6); color: white; padding: 3px 8px; border-radius: 6px; }
        .btn-full { width: 100%; padding: 12px; border-radius: 30px; font-weight: bold; margin-top: 10px; cursor: pointer; border: none; font-family: 'Fredoka', sans-serif; }
        .btn-gray { background: #f0f0f0; color: #555; }
        .btn-primary { background: var(--primary); color: white; }

        .count-badge { font-size: 0.7rem; background: rgba(0,0,0,0.1); padding: 2px 6px; border-radius: 10px; margin-left: 5px; }
    </style>
</head>
<body>

<div class="modal-overlay" id="imgModal" onclick="closeModal()">
    <div class="modal-content" onclick="event.stopPropagation()">
        <div class="modal-img-container">
            <div class="modal-loading" id="modalLoader">ğŸ“¡ æœå°‹ä¸­...</div>
            <img src="" alt="Learning Image" class="modal-img" id="realImage" onerror="handleFallback()">
            <span class="source-tag" id="imgSource">Wiki</span>
        </div>
        <span class="modal-word" id="modalEn">Word</span>
        <span class="modal-zh" id="modalZh">ä¸­æ–‡</span>
        <button class="btn-full btn-gray" onclick="forceRandomReload()">ğŸ”„ åœ–ç‰‡ä¸æº–ï¼Ÿæ›ä¸€å¼µ</button>
        <button class="btn-full btn-primary" onclick="closeModal()">é—œé–‰</button>
    </div>
</div>

<div id="focusOverlay">
    <button class="close-overlay-btn" onclick="toggleFocusMode()">âœ•</button>
    
    <button class="focus-nav-btn prev-btn" onclick="focusNav(-1)">â®</button>
    <button class="focus-nav-btn next-btn" onclick="focusNav(1)">â¯</button>
    
    <div class="focus-card" id="focusCard" onclick="handleFocusClick()">
        <div class="focus-card-bg" id="focusBg"></div>
        <div class="focus-content-layer">
            <div class="focus-rule" id="focusRule"></div>
            <div id="focusContent"></div> 
            
            <div class="focus-controls">
                <button class="snail-btn" onclick="playSlow(event)">ğŸŒ</button>
                
                <div class="focus-mic-container" id="focusMicContainer">
                    <svg class="focus-progress-ring" width="70" height="70">
                       <circle class="focus-progress-ring__circle" stroke="#FF5252" stroke-width="4" fill="transparent" r="32" cx="35" cy="35"/>
                    </svg>
                    <button class="focus-mic-btn" onclick="toggleRecord(event, this)">ğŸ¤</button>
                </div>

                <button class="fav-btn" id="btnFav" onclick="toggleFavorite(event)">â¤ï¸</button>
            </div>
        </div>
    </div>
</div>

<div class="header-area">
    <div class="header-inner">
        <div class="top-row">
            <h1>ğŸ¦ Eliza's English Playground</h1>
            <div class="search-box">
                <input type="search" class="search-input" id="searchInput" placeholder="ğŸ” æœå°‹å–®å­—..." oninput="handleSearch()">
            </div>
        </div>
        
        <div class="tools-row">
            <button class="tool-btn" id="btnQuiz" onclick="toggleQuiz()">âš”ï¸ æŒ‘æˆ°æ¨¡å¼</button>
            
            <button class="tool-btn lang-btn active" id="btnZh" onclick="toggleZh()">ä¸­æ–‡</button>
            <button class="tool-btn lang-btn active" id="btnEn" onclick="toggleEn()">è‹±æ–‡</button>

            <button class="tool-btn" id="btnFocus" onclick="toggleFocusMode()">ğŸƒ ç¿»ç¿»å¡</button>
        </div>

        <div class="nav-scroller" id="navBar"></div>
    </div>
</div>

<div class="spacer"></div>

<div class="main-container">
    <div id="quizArea">
        <div id="quizQuestion">ğŸ”Š è½è²éŸ³æ‰¾æ‰¾çœ‹ï¼</div>
    </div>
    <div class="grid" id="cardGrid"></div>
</div>

<script>
    // =========================================================
    //  1. è©åº« (è³‡æ–™ä¿æŒä¸è®Š)
    // =========================================================
    const db = {
        "ğŸ”¤ å­—æ¯ A-Z": [
            { rule: "A", en: "Apple", zh: "è˜‹æœ", icon: "ğŸ", speak: "A, Apple" },
            { rule: "A", en: "Ant", zh: "èèŸ»", icon: "ğŸœ", speak: "A, Ant" },
            { rule: "B", en: "Bear", zh: "ç†Š", icon: "ğŸ»", speak: "B, Bear" },
            { rule: "B", en: "Ball", zh: "çƒ", icon: "âš½", speak: "B, Ball" },
            { rule: "C", en: "Cat", zh: "è²“", icon: "ğŸ±", speak: "C, Cat" },
            { rule: "C", en: "Car", zh: "è»Š", icon: "ğŸš—", speak: "C, Car" },
            { rule: "D", en: "Dog", zh: "ç‹—", icon: "ğŸ¶", speak: "D, Dog" },
            { rule: "E", en: "Elephant", zh: "å¤§è±¡", icon: "ğŸ˜", speak: "E, Elephant" },
            { rule: "E", en: "Egg", zh: "è›‹", icon: "ğŸ¥š", speak: "E, Egg" },
            { rule: "F", en: "Frog", zh: "é’è›™", icon: "ğŸ¸", speak: "F, Frog" },
            { rule: "F", en: "Fish", zh: "é­š", icon: "ğŸŸ", speak: "F, Fish" },
            { rule: "G", en: "Goat", zh: "å±±ç¾Š", icon: "ğŸ", speak: "G, Goat" },
            { rule: "H", en: "Hat", zh: "å¸½å­", icon: "ğŸ‘’", speak: "H, Hat" },
            { rule: "I", en: "Igloo", zh: "å†°å±‹", icon: "ğŸ›–", speak: "I, Igloo" },
            { rule: "J", en: "Jet", zh: "å™´å°„æ©Ÿ", icon: "âœˆï¸", speak: "J, Jet" },
            { rule: "K", en: "Kite", zh: "é¢¨ç®", icon: "ğŸª", speak: "K, Kite" },
            { rule: "L", en: "Lion", zh: "ç…å­", icon: "ğŸ¦", speak: "L, Lion" },
            { rule: "M", en: "Monkey", zh: "çŒ´å­", icon: "ğŸ’", speak: "M, Monkey" },
            { rule: "N", en: "Nest", zh: "é³¥å·¢", icon: "ğŸªº", speak: "N, Nest" },
            { rule: "O", en: "Octopus", zh: "ç« é­š", icon: "ğŸ™", speak: "O, Octopus" },
            { rule: "P", en: "Pig", zh: "è±¬", icon: "ğŸ·", speak: "P, Pig" },
            { rule: "Q", en: "Queen", zh: "å¥³ç‹", icon: "ğŸ‘¸", speak: "Q, Queen" },
            { rule: "R", en: "Rabbit", zh: "å…”å­", icon: "ğŸ°", speak: "R, Rabbit" },
            { rule: "S", en: "Sun", zh: "å¤ªé™½", icon: "â˜€ï¸", speak: "S, Sun" },
            { rule: "T", en: "Tiger", zh: "è€è™", icon: "ğŸ¯", speak: "T, Tiger" },
            { rule: "U", en: "Umbrella", zh: "é›¨å‚˜", icon: "â˜”", speak: "U, Umbrella" },
            { rule: "V", en: "Van", zh: "å»‚å‹è»Š", icon: "ğŸš", speak: "V, Van" },
            { rule: "W", en: "Wolf", zh: "ç‹¼", icon: "ğŸº", speak: "W, Wolf" },
            { rule: "X", en: "Box", zh: "ç®±å­", icon: "ğŸ“¦", speak: "X, Box" },
            { rule: "Y", en: "Yo-yo", zh: "æºœæºœçƒ", icon: "ğŸª€", speak: "Y, Yo-yo" },
            { rule: "Z", en: "Zebra", zh: "æ–‘é¦¬", icon: "ğŸ¦“", speak: "Z, Zebra" }
        ],
        "ğŸ”¤ çŸ­æ¯éŸ³ Short Vowels": [
            { rule: "Short a", en: "Cat", zh: "è²“", icon: "ğŸ±", speak: "Short a, Cat" },
            { rule: "Short a", en: "Hat", zh: "å¸½å­", icon: "ğŸ‘’", speak: "Short a, Hat" },
            { rule: "Short a", en: "Map", zh: "åœ°åœ–", icon: "ğŸ—ºï¸", speak: "Short a, Map" },
            { rule: "Short a", en: "Dad", zh: "çˆ¸çˆ¸", icon: "ğŸ‘¨", speak: "Short a, Dad" },
            { rule: "Short e", en: "Hen", zh: "æ¯é›", icon: "ğŸ”", speak: "Short e, Hen" },
            { rule: "Short e", en: "Pen", zh: "ç­†", icon: "ğŸ–Šï¸", speak: "Short e, Pen" },
            { rule: "Short e", en: "Bed", zh: "åºŠ", icon: "ğŸ›ï¸", speak: "Short e, Bed" },
            { rule: "Short i", en: "Pig", zh: "è±¬", icon: "ğŸ·", speak: "Short i, Pig" },
            { rule: "Short i", en: "Wig", zh: "å‡é«®", icon: "ğŸ¦³", speak: "Short i, Wig" },
            { rule: "Short i", en: "Bin", zh: "æ¡¶å­", icon: "ğŸ—‘ï¸", speak: "Short i, Bin" },
            { rule: "Short o", en: "Dog", zh: "ç‹—", icon: "ğŸ¶", speak: "Short o, Dog" },
            { rule: "Short o", en: "Fox", zh: "ç‹ç‹¸", icon: "ğŸ¦Š", speak: "Short o, Fox" },
            { rule: "Short o", en: "Box", zh: "ç®±å­", icon: "ğŸ“¦", speak: "Short o, Box" },
            { rule: "Short u", en: "Bus", zh: "å…¬è»Š", icon: "ğŸšŒ", speak: "Short u, Bus" },
            { rule: "Short u", en: "Bug", zh: "èŸ²", icon: "ğŸª²", speak: "Short u, Bug" },
            { rule: "Short u", en: "Cup", zh: "æ¯å­", icon: "â˜•", speak: "Short u, Cup" }
        ],
        "ğŸ”¤ é•·æ¯éŸ³ Long Vowels": [
            { rule: "a_e", en: "Cake", zh: "è›‹ç³•", icon: "ğŸ‚", speak: "Long a, Cake" },
            { rule: "a_e", en: "Snake", zh: "è›‡", icon: "ğŸ", speak: "Long a, Snake" },
            { rule: "a_e", en: "Grape", zh: "è‘¡è„", icon: "ğŸ‡", speak: "Long a, Grape" },
            { rule: "ee", en: "Tree", zh: "æ¨¹", icon: "ğŸŒ³", speak: "Long e, Tree" },
            { rule: "ee", en: "Bee", zh: "èœœèœ‚", icon: "ğŸ", speak: "Long e, Bee" },
            { rule: "ee", en: "Sheep", zh: "ç¶¿ç¾Š", icon: "ğŸ‘", speak: "Long e, Sheep" },
            { rule: "i_e", en: "Kite", zh: "é¢¨ç®", icon: "ğŸª", speak: "Long i, Kite" },
            { rule: "i_e", en: "Bike", zh: "è…³è¸è»Š", icon: "ğŸš²", speak: "Long i, Bike" },
            { rule: "i_e", en: "Five", zh: "äº”", icon: "5ï¸âƒ£", speak: "Long i, Five" },
            { rule: "o_e", en: "Bone", zh: "éª¨é ­", icon: "ğŸ¦´", speak: "Long o, Bone" },
            { rule: "o_e", en: "Rose", zh: "ç«ç‘°", icon: "ğŸŒ¹", speak: "Long o, Rose" },
            { rule: "o_e", en: "Phone", zh: "é›»è©±", icon: "ğŸ“±", speak: "Long o, Phone" },
            { rule: "u_e", en: "Cube", zh: "æ–¹å¡Š", icon: "ğŸ§Š", speak: "Long u, Cube" },
            { rule: "u_e", en: "Cute", zh: "å¯æ„›", icon: "ğŸ¥º", speak: "Long u, Cute" }
        ],
        "ğŸ”¤ é›™å­—æ¯/æ··åˆéŸ³": [
            { rule: "sh", en: "Ship", zh: "èˆ¹", icon: "ğŸš¢", speak: "S-H, Ship" },
            { rule: "sh", en: "Fish", zh: "é­š", icon: "ğŸŸ", speak: "S-H, Fish" },
            { rule: "ch", en: "Chair", zh: "æ¤…å­", icon: "ğŸª‘", speak: "C-H, Chair" },
            { rule: "ch", en: "Cheese", zh: "èµ·å¸", icon: "ğŸ§€", speak: "C-H, Cheese" },
            { rule: "th", en: "Thumb", zh: "å¤§æ‹‡æŒ‡", icon: "ğŸ‘", speak: "T-H, Thumb" },
            { rule: "wh", en: "Whale", zh: "é¯¨é­š", icon: "ğŸ‹", speak: "W-H, Whale" },
            { rule: "bl", en: "Blue", zh: "è—è‰²", icon: "ğŸ”µ", speak: "b-l, Blue" },
            { rule: "fl", en: "Flower", zh: "èŠ±", icon: "ğŸŒ»", speak: "f-l, Flower" },
            { rule: "st", en: "Star", zh: "æ˜Ÿæ˜Ÿ", icon: "â­", speak: "s-t, Star" }
        ],
        // --- èˆˆè¶£ä¸»é¡Œ ---
        "ğŸŒ ä¸–ç•Œåœ°åœ– World": [
            { en: "Taiwan", zh: "å°ç£", icon: "ğŸ‡¹ğŸ‡¼", code: "tw" },
            { en: "USA", zh: "ç¾åœ‹", icon: "ğŸ‡ºğŸ‡¸", code: "us" },
            { en: "Japan", zh: "æ—¥æœ¬", icon: "ğŸ‡¯ğŸ‡µ", code: "jp" },
            { en: "China", zh: "ä¸­åœ‹", icon: "ğŸ‡¨ğŸ‡³", code: "cn" },
            { en: "UK", zh: "è‹±åœ‹", icon: "ğŸ‡¬ğŸ‡§", code: "gb" },
            { en: "France", zh: "æ³•åœ‹", icon: "ğŸ‡«ğŸ‡·", code: "fr" },
            { en: "Germany", zh: "å¾·åœ‹", icon: "ğŸ‡©ğŸ‡ª", code: "de" },
            { en: "Italy", zh: "ç¾©å¤§åˆ©", icon: "ğŸ‡®ğŸ‡¹", code: "it" },
            { en: "Canada", zh: "åŠ æ‹¿å¤§", icon: "ğŸ‡¨ğŸ‡¦", code: "ca" },
            { en: "Australia", zh: "æ¾³æ´²", icon: "ğŸ‡¦ğŸ‡º", code: "au" },
            { en: "India", zh: "å°åº¦", icon: "ğŸ‡®ğŸ‡³", code: "in" },
            { en: "Brazil", zh: "å·´è¥¿", icon: "ğŸ‡§ğŸ‡·", code: "br" },
            { en: "Egypt", zh: "åŸƒåŠ", icon: "ğŸ‡ªğŸ‡¬", code: "eg" },
            { en: "Korea", zh: "éŸ“åœ‹", icon: "ğŸ‡°ğŸ‡·", code: "kr" },
            { en: "Russia", zh: "ä¿„ç¾…æ–¯", icon: "ğŸ‡·ğŸ‡º", code: "ru" },
            { en: "Singapore", zh: "æ–°åŠ å¡", icon: "ğŸ‡¸ğŸ‡¬", code: "sg" },
            { en: "Thailand", zh: "æ³°åœ‹", icon: "ğŸ‡¹ğŸ‡­", code: "th" },
            { en: "World", zh: "ä¸–ç•Œ", icon: "ğŸŒ" }
        ],
        "ğŸ¦– æé¾ Dinosaurs": [
            { en: "T-Rex", zh: "æš´é¾", icon: "ğŸ¦–" },
            { en: "Triceratops", zh: "ä¸‰è§’é¾", icon: "ğŸ¦•" },
            { en: "Brachiosaurus", zh: "è…•é¾", icon: "ğŸ¦•" },
            { en: "Stegosaurus", zh: "åŠé¾", icon: "ğŸ¦" },
            { en: "Pteranodon", zh: "ç¿¼é¾", icon: "ğŸ¦…" },
            { en: "Velociraptor", zh: "è¿…çŒ›é¾", icon: "ğŸ¦–" },
            { en: "Dinosaur Egg", zh: "æé¾è›‹", icon: "ğŸ¥š" },
            { en: "Fossil", zh: "åŒ–çŸ³", icon: "ğŸ¦´" },
            { en: "Volcano", zh: "ç«å±±", icon: "ğŸŒ‹" }
        ],
        "ğŸª å®‡å®™ Space": [
            { en: "Sun", zh: "å¤ªé™½", icon: "â˜€ï¸" },
            { en: "Moon", zh: "æœˆäº®", icon: "ğŸŒ™" },
            { en: "Earth", zh: "åœ°çƒ", icon: "ğŸŒ" },
            { en: "Star", zh: "æ˜Ÿæ˜Ÿ", icon: "â­" },
            { en: "Rocket", zh: "ç«ç®­", icon: "ğŸš€" },
            { en: "Astronaut", zh: "å¤ªç©ºäºº", icon: "ğŸ§‘â€ğŸš€" },
            { en: "Alien", zh: "å¤–æ˜Ÿäºº", icon: "ğŸ‘½" },
            { en: "UFO", zh: "é£›ç¢Ÿ", icon: "ğŸ›¸" },
            { en: "Planet", zh: "è¡Œæ˜Ÿ", icon: "ğŸª" },
            { en: "Mars", zh: "ç«æ˜Ÿ", icon: "ğŸ”´" }
        ],
        "ğŸš’ äº¤é€š Vehicles": [
            { en: "Car", zh: "æ±½è»Š", icon: "ğŸš—" },
            { en: "Bus", zh: "å…¬è»Š", icon: "ğŸšŒ" },
            { en: "Police Car", zh: "è­¦è»Š", icon: "ğŸš“" },
            { en: "Fire Truck", zh: "æ¶ˆé˜²è»Š", icon: "ğŸš’" },
            { en: "Ambulance", zh: "æ•‘è­·è»Š", icon: "ğŸš‘" },
            { en: "Taxi", zh: "è¨ˆç¨‹è»Š", icon: "ğŸš•" },
            { en: "Truck", zh: "å¡è»Š", icon: "ğŸšš" },
            { en: "Train", zh: "ç«è»Š", icon: "ğŸš‚" },
            { en: "Airplane", zh: "é£›æ©Ÿ", icon: "âœˆï¸" },
            { en: "Helicopter", zh: "ç›´å‡æ©Ÿ", icon: "ğŸš" },
            { en: "Boat", zh: "èˆ¹", icon: "ğŸš¢" },
            { en: "Bicycle", zh: "è…³è¸è»Š", icon: "ğŸš²" },
            { en: "Motorcycle", zh: "æ©Ÿè»Š", icon: "ğŸ›µ" },
            { en: "Scooter", zh: "æ»‘æ¿è»Š", icon: "ğŸ›´" },
            { en: "Excavator", zh: "æŒ–åœŸæ©Ÿ", icon: "ğŸ—ï¸" },
            { en: "Tractor", zh: "æ‹–æ‹‰æ©Ÿ", icon: "ğŸšœ" }
        ],
        "ğŸ¦ å‹•ç‰©åœ’ Zoo": [
            { en: "Lion", zh: "ç…å­", icon: "ğŸ¦" },
            { en: "Tiger", zh: "è€è™", icon: "ğŸ¯" },
            { en: "Elephant", zh: "å¤§è±¡", icon: "ğŸ˜" },
            { en: "Monkey", zh: "çŒ´å­", icon: "ğŸ’" },
            { en: "Zebra", zh: "æ–‘é¦¬", icon: "ğŸ¦“" },
            { en: "Giraffe", zh: "é•·é ¸é¹¿", icon: "ğŸ¦’" },
            { en: "Bear", zh: "ç†Š", icon: "ğŸ»" },
            { en: "Panda", zh: "ç†Šè²“", icon: "ğŸ¼" },
            { en: "Kangaroo", zh: "è¢‹é¼ ", icon: "ğŸ¦˜" },
            { en: "Hippo", zh: "æ²³é¦¬", icon: "ğŸ¦›" },
            { en: "Crocodile", zh: "é±·é­š", icon: "ğŸŠ" },
            { en: "Penguin", zh: "ä¼éµ", icon: "ğŸ§" },
            { en: "Koala", zh: "ç„¡å°¾ç†Š", icon: "ğŸ¨" }
        ],
        "ğŸ· è¾²å ´å‹•ç‰© Farm": [
            { en: "Dog", zh: "ç‹—", icon: "ğŸ¶" },
            { en: "Cat", zh: "è²“", icon: "ğŸ±" },
            { en: "Pig", zh: "è±¬", icon: "ğŸ·" },
            { en: "Cow", zh: "ç‰›", icon: "ğŸ„" },
            { en: "Sheep", zh: "ç¶¿ç¾Š", icon: "ğŸ‘" },
            { en: "Goat", zh: "å±±ç¾Š", icon: "ğŸ" },
            { en: "Horse", zh: "é¦¬", icon: "ğŸ" },
            { en: "Chicken", zh: "é›", icon: "ğŸ”" },
            { en: "Rooster", zh: "å…¬é›", icon: "ğŸ“" },
            { en: "Duck", zh: "é´¨å­", icon: "ğŸ¦†" },
            { en: "Rabbit", zh: "å…”å­", icon: "ğŸ°" },
            { en: "Mouse", zh: "è€é¼ ", icon: "ğŸ­" }
        ],
        "ğŸ¬ æµ·æ´‹ç”Ÿç‰© Ocean": [
            { en: "Whale", zh: "é¯¨é­š", icon: "ğŸ‹" },
            { en: "Dolphin", zh: "æµ·è±š", icon: "ğŸ¬" },
            { en: "Shark", zh: "é¯Šé­š", icon: "ğŸ¦ˆ" },
            { en: "Octopus", zh: "ç« é­š", icon: "ğŸ™" },
            { en: "Squid", zh: "çƒè³Š", icon: "ğŸ¦‘" },
            { en: "Crab", zh: "èƒèŸ¹", icon: "ğŸ¦€" },
            { en: "Lobster", zh: "é¾è¦", icon: "ğŸ¦" },
            { en: "Shrimp", zh: "è¦å­", icon: "ğŸ¦" },
            { en: "Fish", zh: "é­š", icon: "ğŸ " },
            { en: "Turtle", zh: "çƒé¾œ", icon: "ğŸ¢" },
            { en: "Penguin", zh: "ä¼éµ", icon: "ğŸ§" },
            { en: "Seal", zh: "æµ·è±¹", icon: "ğŸ¦­" }
        ],
        "ğŸ æ˜†èŸ²ä¸–ç•Œ Bugs": [
            { en: "Butterfly", zh: "è´è¶", icon: "ğŸ¦‹" },
            { en: "Bee", zh: "èœœèœ‚", icon: "ğŸ" },
            { en: "Ant", zh: "èèŸ»", icon: "ğŸœ" },
            { en: "Ladybug", zh: "ç“¢èŸ²", icon: "ğŸ" },
            { en: "Spider", zh: "èœ˜è››", icon: "ğŸ•·ï¸" },
            { en: "Caterpillar", zh: "æ¯›æ¯›èŸ²", icon: "ğŸ›" },
            { en: "Snail", zh: "è¸ç‰›", icon: "ğŸŒ" },
            { en: "Mosquito", zh: "èšŠå­", icon: "ğŸ¦Ÿ" },
            { en: "Beetle", zh: "ç”²èŸ²", icon: "ğŸª²" },
            { en: "Scorpion", zh: "è å­", icon: "ğŸ¦‚" }
        ],
        "ğŸ æ°´æœ Fruits": [
            { en: "Apple", zh: "è˜‹æœ", icon: "ğŸ" },
            { en: "Banana", zh: "é¦™è•‰", icon: "ğŸŒ" },
            { en: "Grape", zh: "è‘¡è„", icon: "ğŸ‡" },
            { en: "Watermelon", zh: "è¥¿ç“œ", icon: "ğŸ‰" },
            { en: "Strawberry", zh: "è‰è“", icon: "ğŸ“" },
            { en: "Cherry", zh: "æ«»æ¡ƒ", icon: "ğŸ’" },
            { en: "Peach", zh: "æ¡ƒå­", icon: "ğŸ‘" },
            { en: "Pineapple", zh: "é³³æ¢¨", icon: "ğŸ" },
            { en: "Mango", zh: "èŠ’æœ", icon: "ğŸ¥­" },
            { en: "Lemon", zh: "æª¸æª¬", icon: "ğŸ‹" },
            { en: "Orange", zh: "æ©˜å­", icon: "ğŸŠ" },
            { en: "Kiwi", zh: "å¥‡ç•°æœ", icon: "ğŸ¥" },
            { en: "Melon", zh: "å“ˆå¯†ç“œ", icon: "ğŸˆ" },
            { en: "Pear", zh: "æ¢¨å­", icon: "ğŸ" }
        ],
        "ğŸ¥¦ è”¬èœ Vegetables": [
            { en: "Carrot", zh: "ç´…è˜¿è””", icon: "ğŸ¥•" },
            { en: "Corn", zh: "ç‰ç±³", icon: "ğŸŒ½" },
            { en: "Broccoli", zh: "èŠ±æ¤°èœ", icon: "ğŸ¥¦" },
            { en: "Mushroom", zh: "è˜‘è‡", icon: "ğŸ„" },
            { en: "Tomato", zh: "ç•ªèŒ„", icon: "ğŸ…" },
            { en: "Potato", zh: "é¦¬éˆ´è–¯", icon: "ğŸ¥”" },
            { en: "Onion", zh: "æ´‹è”¥", icon: "ğŸ§…" },
            { en: "Garlic", zh: "å¤§è’œ", icon: "ğŸ§„" },
            { en: "Pepper", zh: "è¾£æ¤’", icon: "ğŸŒ¶ï¸" },
            { en: "Cucumber", zh: "å°é»ƒç“œ", icon: "ğŸ¥’" },
            { en: "Eggplant", zh: "èŒ„å­", icon: "ğŸ†" }
        ],
        "ğŸ” ç¾é£Ÿ Food": [
            { en: "Hamburger", zh: "æ¼¢å ¡", icon: "ğŸ”" },
            { en: "Fries", zh: "è–¯æ¢", icon: "ğŸŸ" },
            { en: "Pizza", zh: "æŠ«è–©", icon: "ğŸ•" },
            { en: "Hotdog", zh: "ç†±ç‹—", icon: "ğŸŒ­" },
            { en: "Sandwich", zh: "ä¸‰æ˜æ²»", icon: "ğŸ¥ª" },
            { en: "Taco", zh: "å¡”å¯é¤…", icon: "ğŸŒ®" },
            { en: "Rice", zh: "é£¯", icon: "ğŸš" },
            { en: "Noodles", zh: "éºµ", icon: "ğŸœ" },
            { en: "Spaghetti", zh: "ç¾©å¤§åˆ©éºµ", icon: "ğŸ" },
            { en: "Sushi", zh: "å£½å¸", icon: "ğŸ£" },
            { en: "Bread", zh: "éºµåŒ…", icon: "ğŸ" },
            { en: "Egg", zh: "è›‹", icon: "ğŸ³" },
            { en: "Meat", zh: "è‚‰", icon: "ğŸ¥©" },
            { en: "Chicken", zh: "é›è…¿", icon: "ğŸ—" }
        ],
        "ğŸ° ç”œé» Sweets": [
            { en: "Ice Cream", zh: "å†°æ·‡æ·‹", icon: "ğŸ¦" },
            { en: "Cake", zh: "è›‹ç³•", icon: "ğŸ°" },
            { en: "Cookie", zh: "é¤…ä¹¾", icon: "ğŸª" },
            { en: "Donut", zh: "ç”œç”œåœˆ", icon: "ğŸ©" },
            { en: "Chocolate", zh: "å·§å…‹åŠ›", icon: "ğŸ«" },
            { en: "Candy", zh: "ç³–æœ", icon: "ğŸ¬" },
            { en: "Lollipop", zh: "æ£’æ£’ç³–", icon: "ğŸ­" },
            { en: "Popcorn", zh: "çˆ†ç±³èŠ±", icon: "ğŸ¿" },
            { en: "Pudding", zh: "å¸ƒä¸", icon: "ğŸ®" },
            { en: "Honey", zh: "èœ‚èœœ", icon: "ğŸ¯" },
            { en: "Milk", zh: "ç‰›å¥¶", icon: "ğŸ¥›" },
            { en: "Juice", zh: "æœæ±", icon: "ğŸ§ƒ" }
        ],
        "ğŸ‘• è¡£æœ Clothing": [
            { en: "T-shirt", zh: "Tæ¤", icon: "ğŸ‘•" },
            { en: "Jeans", zh: "ç‰›ä»”è¤²", icon: "ğŸ‘–" },
            { en: "Dress", zh: "æ´‹è£", icon: "ğŸ‘—" },
            { en: "Coat", zh: "å¤–å¥—", icon: "ğŸ§¥" },
            { en: "Socks", zh: "è¥ªå­", icon: "ğŸ§¦" },
            { en: "Shoe", zh: "é‹å­", icon: "ğŸ‘Ÿ" },
            { en: "Hat", zh: "å¸½å­", icon: "ğŸ§¢" },
            { en: "Scarf", zh: "åœå·¾", icon: "ğŸ§£" },
            { en: "Gloves", zh: "æ‰‹å¥—", icon: "ğŸ§¤" },
            { en: "Glasses", zh: "çœ¼é¡", icon: "ğŸ‘“" },
            { en: "Tie", zh: "é ˜å¸¶", icon: "ğŸ‘”" },
            { en: "Bag", zh: "åŒ…åŒ…", icon: "ğŸ’" },
            { en: "Umbrella", zh: "é›¨å‚˜", icon: "ğŸŒ‚" },
            { en: "Ring", zh: "æˆ’æŒ‡", icon: "ğŸ’" }
        ],
        "ğŸ« å­¸æ ¡ School": [
            { en: "Pencil", zh: "é‰›ç­†", icon: "âœï¸" },
            { en: "Pen", zh: "åŸå­ç­†", icon: "ğŸ–Šï¸" },
            { en: "Book", zh: "æ›¸", icon: "ğŸ“–" },
            { en: "Notebook", zh: "ç­†è¨˜æœ¬", icon: "ğŸ““" },
            { en: "Ruler", zh: "å°º", icon: "ğŸ“" },
            { en: "Scissors", zh: "å‰ªåˆ€", icon: "âœ‚ï¸" },
            { en: "Crayon", zh: "è Ÿç­†", icon: "ğŸ–ï¸" },
            { en: "Backpack", zh: "æ›¸åŒ…", icon: "ğŸ’" },
            { en: "Computer", zh: "é›»è…¦", icon: "ğŸ’»" },
            { en: "Art", zh: "ç¾è¡“", icon: "ğŸ¨" },
            { en: "Music", zh: "éŸ³æ¨‚", icon: "ğŸµ" },
            { en: "Bus", zh: "æ ¡è»Š", icon: "ğŸšŒ" }
        ],
        "âš½ é‹å‹• Sports": [
            { en: "Soccer", zh: "è¶³çƒ", icon: "âš½" },
            { en: "Basketball", zh: "ç±ƒçƒ", icon: "ğŸ€" },
            { en: "Baseball", zh: "æ£’çƒ", icon: "âš¾" },
            { en: "Tennis", zh: "ç¶²çƒ", icon: "ğŸ¾" },
            { en: "Volleyball", zh: "æ’çƒ", icon: "ğŸ" },
            { en: "Ping Pong", zh: "æ¡Œçƒ", icon: "ğŸ“" },
            { en: "Badminton", zh: "ç¾½çƒ", icon: "ğŸ¸" },
            { en: "Bowling", zh: "ä¿é½¡çƒ", icon: "ğŸ³" },
            { en: "Swimming", zh: "æ¸¸æ³³", icon: "ğŸŠ" },
            { en: "Running", zh: "è·‘æ­¥", icon: "ğŸƒ" },
            { en: "Cycling", zh: "é¨è»Š", icon: "ğŸš´" },
            { en: "Trophy", zh: "çç›ƒ", icon: "ğŸ†" }
        ],
        "â›… å¤©æ°£ Weather": [
            { en: "Sunny", zh: "æ™´å¤©", icon: "â˜€ï¸" },
            { en: "Cloudy", zh: "å¤šé›²", icon: "â˜ï¸" },
            { en: "Rainy", zh: "é›¨å¤©", icon: "ğŸŒ§ï¸" },
            { en: "Snowy", zh: "ä¸‹é›ª", icon: "ğŸŒ¨ï¸" },
            { en: "Windy", zh: "é¢³é¢¨", icon: "ğŸŒ¬ï¸" },
            { en: "Storm", zh: "æš´é¢¨é›¨", icon: "â›ˆï¸" },
            { en: "Thunder", zh: "æ‰“é›·", icon: "âš¡" },
            { en: "Rainbow", zh: "å½©è™¹", icon: "ğŸŒˆ" },
            { en: "Star", zh: "æ˜Ÿæ˜Ÿ", icon: "â­" },
            { en: "Moon", zh: "æœˆäº®", icon: "ğŸŒ™" }
        ],
        "ğŸ˜Š æƒ…ç·’ Feelings": [
            { en: "Happy", zh: "å¿«æ¨‚", icon: "ğŸ˜Š" },
            { en: "Sad", zh: "é›£é", icon: "ğŸ˜¢" },
            { en: "Angry", zh: "ç”Ÿæ°£", icon: "ğŸ˜ " },
            { en: "Surprised", zh: "é©šè¨", icon: "ğŸ˜²" },
            { en: "Scared", zh: "å®³æ€•", icon: "ğŸ˜±" },
            { en: "Sleepy", zh: "æƒ³ç¡", icon: "ğŸ˜´" },
            { en: "Sick", zh: "ç”Ÿç—…", icon: "ğŸ¤’" },
            { en: "Cold", zh: "å†·", icon: "ğŸ¥¶" },
            { en: "Hot", zh: "ç†±", icon: "ğŸ¥µ" },
            { en: "Love", zh: "æ„›", icon: "ğŸ¥°" }
        ],
        "ğŸ‘· è·æ¥­ Jobs": [
            { en: "Doctor", zh: "é†«ç”Ÿ", icon: "ğŸ‘¨â€âš•ï¸" },
            { en: "Police", zh: "è­¦å¯Ÿ", icon: "ğŸ‘®" },
            { en: "Firefighter", zh: "æ¶ˆé˜²å“¡", icon: "ğŸ§‘â€ğŸš’" },
            { en: "Teacher", zh: "è€å¸«", icon: "ğŸ‘©â€ğŸ«" },
            { en: "Cook", zh: "å»šå¸«", icon: "ğŸ‘¨â€ğŸ³" },
            { en: "Farmer", zh: "è¾²å¤«", icon: "ğŸ‘¨â€ğŸŒ¾" }
        ],
        // --- èªçŸ¥åŸºç¤ ---
        "ğŸ”¢ æ•¸å­— Numbers": [
            { en: "One", zh: "1", speak: "One", icon: "1ï¸âƒ£" },
            { en: "Two", zh: "2", speak: "Two", icon: "2ï¸âƒ£" },
            { en: "Three", zh: "3", speak: "Three", icon: "3ï¸âƒ£" },
            { en: "Four", zh: "4", speak: "Four", icon: "4ï¸âƒ£" },
            { en: "Five", zh: "5", speak: "Five", icon: "5ï¸âƒ£" },
            { en: "Six", zh: "6", speak: "Six", icon: "6ï¸âƒ£" },
            { en: "Seven", zh: "7", speak: "Seven", icon: "7ï¸âƒ£" },
            { en: "Eight", zh: "8", speak: "Eight", icon: "8ï¸âƒ£" },
            { en: "Nine", zh: "9", speak: "Nine", icon: "9ï¸âƒ£" },
            { en: "Ten", zh: "10", speak: "Ten", icon: "ğŸ”Ÿ" }
        ],
        "ğŸ¨ é¡è‰² Colors": [
            { en: "Red", zh: "ç´…è‰²", icon: "ğŸŸ¥" },
            { en: "Blue", zh: "è—è‰²", icon: "ğŸŸ¦" },
            { en: "Yellow", zh: "é»ƒè‰²", icon: "ğŸŸ¨" },
            { en: "Green", zh: "ç¶ è‰²", icon: "ğŸŸ©" },
            { en: "Orange", zh: "æ©˜è‰²", icon: "ğŸŸ§" },
            { en: "Purple", zh: "ç´«è‰²", icon: "ğŸŸª" },
            { en: "Pink", zh: "ç²‰ç´…è‰²", icon: "ğŸŒ¸" },
            { en: "Black", zh: "é»‘è‰²", icon: "â¬›" },
            { en: "White", zh: "ç™½è‰²", icon: "â¬œ" }
        ]
    };

    // ==========================================
    //  2. State
    // ==========================================
    let currentRoom = Object.keys(db)[0];
    let isQuiz = false;
    let quizTarget = null;
    let currentItem = null;
    let imgCache = {};
    let isFocusMode = false;
    let focusIndex = 0;
    let activeItems = []; 
    
    // éŒ„éŸ³ç›¸é—œ
    let mediaRecorder = null; 
    const playbackAudio = new Audio(); 

    // æœ€æ„›
    let favorites = JSON.parse(localStorage.getItem('eliza_favs')) || [];

    // é¡¯ç¤ºè¨­å®š (ç¨ç«‹é–‹é—œ)
    let showZh = true;
    let showEn = true;

    function init() {
        renderNav();
        loadRoom(currentRoom);
        
        // Auto-Hide Header
        let lastScroll = 0;
        const header = document.querySelector('.header-area');
        window.addEventListener('scroll', () => {
            const currentScroll = window.scrollY;
            if (currentScroll > lastScroll && currentScroll > 60) {
                header.classList.add('header-hidden');
            } else if (currentScroll < lastScroll) {
                header.classList.remove('header-hidden');
            }
            lastScroll = currentScroll;
        });
    }

    function renderNav() {
        const nav = document.getElementById('navBar');
        nav.innerHTML = '';
        
        // æœ€æ„›æ¨™ç±¤
        const favBtn = document.createElement('span');
        favBtn.className = `room-tab fav-tab ${currentRoom === 'favorites' ? 'active' : ''}`;
        favBtn.innerText = "â¤ï¸ æœ€æ„›";
        favBtn.onclick = () => {
            document.getElementById('searchInput').value = "";
            loadRoom('favorites');
        };
        nav.appendChild(favBtn);

        // å…¶ä»–æ¨™ç±¤
        Object.keys(db).forEach(room => {
            const btn = document.createElement('span');
            const isPhonics = room.includes("ğŸ”¤");
            const displayName = room.includes(" ") ? room.split(" ")[1] : room;
            btn.className = `room-tab ${room === currentRoom ? 'active' : ''} ${isPhonics ? 'phonics-tab' : ''}`;
            btn.innerText = displayName;
            btn.onclick = () => {
                document.getElementById('searchInput').value = "";
                loadRoom(room);
            };
            nav.appendChild(btn);
        });
    }

    function loadRoom(room) {
        currentRoom = room;
        
        if (room === 'favorites') {
            let favItems = [];
            Object.keys(db).forEach(key => {
                db[key].forEach(item => {
                    if(favorites.includes(item.en)) favItems.push(item);
                });
            });
            activeItems = favItems;
        } else {
            activeItems = db[room];
        }

        renderGrid();
        renderNav();
        if(isQuiz) nextQuestion();
        if(isFocusMode) {
            focusIndex = 0;
            renderFocusCard();
        }
    }

    function handleSearch() {
        const query = document.getElementById('searchInput').value.toLowerCase();
        if(!query) {
            loadRoom(currentRoom);
            return;
        }
        let results = [];
        Object.keys(db).forEach(key => {
            db[key].forEach(item => {
                if(item.en.toLowerCase().includes(query) || item.zh.includes(query)) {
                    results.push(item);
                }
            });
        });
        activeItems = results;
        renderGrid();
        if(isFocusMode) {
            focusIndex = 0;
            renderFocusCard();
        }
    }

    // --- Favorites Logic ---
    function toggleFavorite(event) {
        event.stopPropagation();
        if(activeItems.length === 0) return;
        
        const item = activeItems[focusIndex];
        const index = favorites.indexOf(item.en);
        
        if(index === -1) {
            favorites.push(item.en);
        } else {
            favorites.splice(index, 1);
        }
        
        localStorage.setItem('eliza_favs', JSON.stringify(favorites));
        renderFocusCard(); 
        
        // UX æ”¹é€²ï¼šå¦‚æœæ˜¯åœ¨æœ€æ„›æ¸…å–®ï¼Œä¸è¦ç«‹åˆ»ç§»é™¤ï¼Œç­‰ä¸‹æ¬¡é€²ä¾†å†ç§»é™¤
    }

    // --- Toggle Functions ---
    function toggleZh() {
        showZh = !showZh;
        const btn = document.getElementById('btnZh');
        if(showZh) btn.classList.add('active');
        else btn.classList.remove('active');
        renderGrid();
        if(isFocusMode) renderFocusCard();
    }

    function toggleEn() {
        showEn = !showEn;
        const btn = document.getElementById('btnEn');
        if(showEn) btn.classList.add('active');
        else btn.classList.remove('active');
        renderGrid();
        if(isFocusMode) renderFocusCard();
    }

    function renderGrid() {
        const grid = document.getElementById('cardGrid');
        grid.innerHTML = '';
        
        grid.classList.remove('hide-zh', 'hide-en', 'hide-text');
        if (!showZh) grid.classList.add('hide-zh');
        if (!showEn) grid.classList.add('hide-en');
        if (!showZh && !showEn) grid.classList.add('hide-text'); 

        activeItems.forEach((item, index) => {
            const card = document.createElement('div');
            let classes = ['card'];
            if(item.speak) classes.push('phonics-card');
            card.className = classes.join(' ');
            
            let bgColor = "#f0f0f0";
            if (item.rule) bgColor = stringToPastelColor(item.rule); 
            else bgColor = stringToColor(item.en);

            let visualContent = "";
            let topLabel = "";

            if ((item.rule)) {
                topLabel = `<div class="rule-tag" style="background:${stringToDarkerColor(item.rule)}">${item.rule}</div>`;
                visualContent = `<div class="card-img" style="background:${bgColor}">${item.icon}</div>`;
            } else if (item.code) {
                visualContent = `<div class="card-img"><img src="https://flagcdn.com/h240/${item.code}.png" alt="${item.en}"></div>`;
            } else {
                visualContent = `<div class="card-img" style="background:${bgColor};opacity:0.8">${item.icon}</div>`;
            }
            
            card.innerHTML = `
                ${topLabel}
                ${visualContent}
                <div class="card-body">
                    <span class="en-word">${item.en}</span>
                    <span class="zh-word">${item.zh}</span>
                </div>
            `;
            
            card.onclick = (e) => handleClick(item, card, index);
            grid.appendChild(card);
        });
        
        if(activeItems.length === 0) {
            grid.innerHTML = '<div style="grid-column:1/-1;text-align:center;color:#999;padding:20px;">æ‰¾ä¸åˆ°é€™å€‹å–®å­—å–”...</div>';
        }
    }

    // --- Audio Stream Helper (Fresh Stream for iOS) ---
    async function getFreshStream() {
        try {
            const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
            return stream;
        } catch (err) {
            console.error(err);
            alert("è«‹å…è¨±éº¥å…‹é¢¨æ¬Šé™ä»¥ä½¿ç”¨éŒ„éŸ³åŠŸèƒ½ (éœ€ HTTPS)");
            return null;
        }
    }

    // --- Record Logic (Fixed for iPad) ---
    async function toggleRecord(event, btn) {
        event.stopPropagation(); 

        const container = btn.parentElement;
        if (container.classList.contains('recording')) return;

        // 1. Silent Unlock (Crucial for iOS)
        playbackAudio.src = 'data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEAQB8AAEAfAAABAAgAAABmYWN0BAAAAAAAAABkYXRhAgAAAA==';
        playbackAudio.play().catch(() => {});

        // 2. Request Fresh Stream Every Time
        const stream = await getFreshStream();
        if(!stream) return;

        try {
            let options = {};
            if (MediaRecorder.isTypeSupported('audio/webm')) options = { mimeType: 'audio/webm' };
            else if (MediaRecorder.isTypeSupported('audio/mp4')) options = { mimeType: 'audio/mp4' };
            
            mediaRecorder = new MediaRecorder(stream, options);
            const audioChunks = [];

            mediaRecorder.ondataavailable = event => {
                if (event.data.size > 0) audioChunks.push(event.data);
            };

            mediaRecorder.onstop = () => {
                const blobType = options.mimeType || 'audio/webm';
                const audioBlob = new Blob(audioChunks, { type: blobType });
                const audioUrl = URL.createObjectURL(audioBlob);
                
                playbackAudio.src = audioUrl;
                playbackAudio.play().catch(e => console.log("Playback failed", e));
                
                container.classList.remove('recording');
                
                // IMPORTANT: Stop all tracks to release mic on iPad
                stream.getTracks().forEach(track => track.stop());
            };

            mediaRecorder.start();
            container.classList.add('recording'); 

            setTimeout(() => {
                if (mediaRecorder.state === "recording") {
                    mediaRecorder.stop();
                }
            }, 2000); 

        } catch (err) {
            console.error("Recorder Error:", err);
        }
    }

    function playSlow(event) {
        event.stopPropagation();
        if(activeItems.length === 0) return;
        const item = activeItems[focusIndex];
        const text = item.speak ? item.speak : item.en;
        speak(text, 0.3); // èª¿æ•´è‡³ 0.3 å€é€Ÿ
    }

    function handleClick(item, cardElem, index) {
        if (!isQuiz) {
            const text = item.speak ? item.speak : item.en;
            speak(text);
            
            if(cardElem) {
                cardElem.style.transform = "scale(1.05)";
                setTimeout(() => cardElem.style.transform = "", 200);
            }

            const isPhonicsCategory = item.rule !== undefined;
            if (!isPhonicsCategory && !isFocusMode) {
                currentItem = item;
                openImageModal(item);
            }
        } else {
            if (item.en === quizTarget.en) {
                if(cardElem) cardElem.classList.add('correct');
                if(isFocusMode) {
                    document.getElementById('focusCard').style.borderColor = "#4CAF50";
                    document.getElementById('focusCard').style.background = "#E8F5E9";
                }
                speak("Great job!");
                setTimeout(() => {
                    if(cardElem) cardElem.classList.remove('correct');
                    if(isFocusMode) {
                        const fc = document.getElementById('focusCard');
                        fc.style.borderColor = "white";
                        fc.style.background = "white";
                    }
                    nextQuestion();
                }, 1500);
            } else {
                if(cardElem) cardElem.classList.add('wrong');
                if(isFocusMode) {
                    const fc = document.getElementById('focusCard');
                    fc.style.borderColor = "#F44336";
                    setTimeout(() => fc.style.borderColor = "white", 500);
                }
                speak("Try again!");
                setTimeout(() => { if(cardElem) cardElem.classList.remove('wrong'); }, 500);
            }
        }
    }

    function toggleFocusMode() {
        isFocusMode = !isFocusMode;
        const overlay = document.getElementById('focusOverlay');
        const btn = document.getElementById('btnFocus');
        if(isFocusMode) {
            overlay.style.display = 'flex';
            // btn.classList.add('active'); // Removed: Button is focus trigger
            focusIndex = 0;
            renderFocusCard();
        } else {
            overlay.style.display = 'none';
            // btn.classList.remove('active');
            if (mediaRecorder && mediaRecorder.state === "recording") {
                mediaRecorder.stop();
            }
            
            // If returning from Favorites, reload to reflect removals
            if(currentRoom === 'favorites') {
                loadRoom('favorites');
            }
        }
    }

    function focusNav(dir) {
        focusIndex += dir;
        if(focusIndex < 0) focusIndex = activeItems.length - 1;
        if(focusIndex >= activeItems.length) focusIndex = 0;
        
        if (mediaRecorder && mediaRecorder.state === "recording") {
            mediaRecorder.stop();
            const container = document.getElementById('focusMicContainer');
            if(container) container.classList.remove('recording');
        }
        
        renderFocusCard();
    }
    
    function renderFocusCard() {
        if(activeItems.length === 0) return;
        const item = activeItems[focusIndex];
        const container = document.getElementById('focusContent');
        const ruleDisplay = document.getElementById('focusRule');
        const bgLayer = document.getElementById('focusBg');
        const micContainer = document.getElementById('focusMicContainer');
        const favBtn = document.getElementById('btnFav');
        
        let bgColor = item.rule ? stringToPastelColor(item.rule) : stringToColor(item.en);
        bgLayer.style.background = item.rule ? bgColor : `#${bgColor}`;
        bgLayer.style.opacity = item.rule ? "0.3" : "0.1";

        ruleDisplay.innerText = item.rule ? item.rule : "";
        ruleDisplay.style.color = stringToDarkerColor(item.rule || item.en);

        // Heart State
        if(favorites.includes(item.en)) {
            favBtn.classList.add('active');
            favBtn.innerText = "â¤ï¸";
        } else {
            favBtn.classList.remove('active');
            favBtn.innerText = "ğŸ¤";
        }

        let visual = `<div class="focus-icon">${item.icon}</div>`;
        if(item.code) {
            visual = `<img src="https://flagcdn.com/h240/${item.code}.png" class="focus-flag-img">`;
        }

        let enStyle = showEn ? '' : 'opacity:0';
        let zhStyle = showZh ? '' : 'opacity:0';

        container.innerHTML = `
            ${visual}
            <div class="focus-en" style="${enStyle}">${item.en}</div>
            <div class="focus-zh" style="${zhStyle}">${item.zh}</div>
            <div style="margin-top:20px;color:#999;font-size:0.9rem;">${focusIndex + 1} / ${activeItems.length}</div>
        `;

        if(isQuiz) {
            micContainer.style.display = 'none';
        } else {
            micContainer.style.display = 'flex';
            setTimeout(() => {
                const text = item.speak ? item.speak : item.en;
                speak(text);
            }, 300);
        }
    }

    function handleFocusClick() {
        if(activeItems.length > 0) {
            handleClick(activeItems[focusIndex], null, focusIndex);
        }
    }

    async function openImageModal(item, forceRandom = false) {
        const modal = document.getElementById('imgModal');
        const realImg = document.getElementById('realImage');
        const loader = document.getElementById('modalLoader');
        const sourceTag = document.getElementById('imgSource');
        const enText = document.getElementById('modalEn');
        const zhText = document.getElementById('modalZh');

        modal.style.display = 'flex';
        enText.innerText = item.en;
        zhText.innerText = item.zh;
        
        realImg.style.display = 'none';
        loader.style.display = 'block';
        sourceTag.style.display = 'none';

        if (forceRandom) { loadRandomImage(item.en); return; }
        if (imgCache[item.en]) { showImg(imgCache[item.en], 'Wiki (Cached)'); return; }

        try {
            const keyword = item.en.split(" ")[0].trim().replace(/ /g, "_");
            const wikiUrl = `https://en.wikipedia.org/api/rest_v1/page/summary/${keyword}`;
            const response = await fetch(wikiUrl);
            if (!response.ok) throw new Error("Wiki Not Found");
            const data = await response.json();
            if (data.thumbnail && data.thumbnail.source) {
                const imgSrc = data.thumbnail.source;
                imgCache[item.en] = imgSrc; 
                showImg(imgSrc, 'Wiki');
            } else {
                throw new Error("No Wiki Image");
            }
        } catch (error) {
            loadRandomImage(item.en);
        }
    }

    function loadRandomImage(keywordRaw) {
        const realImg = document.getElementById('realImage');
        const loader = document.getElementById('modalLoader');
        loader.innerText = "ğŸ” æœå°‹ç¶²è·¯ç¾åœ–...";
        let keyword = keywordRaw.split(" ")[0].toLowerCase();
        let searchPath = keyword;
        if (currentRoom.includes("World") || currentRoom.includes("åœ°åœ–")) {
             searchPath = `${keyword},landscape,landmark/all`;
        }
        const randomLock = Math.floor(Math.random() * 10000);
        const imgUrl = `https://loremflickr.com/500/400/${searchPath}?lock=${randomLock}`;
        const tempImg = new Image();
        tempImg.src = imgUrl;
        tempImg.onload = () => showImg(imgUrl, 'Web');
        tempImg.onerror = () => { loader.innerText = "âŒ æ‰¾ä¸åˆ°åœ–ç‰‡"; };
    }

    function showImg(url, source) {
        const realImg = document.getElementById('realImage');
        const loader = document.getElementById('modalLoader');
        const sourceTag = document.getElementById('imgSource');
        realImg.src = url;
        loader.style.display = 'none';
        realImg.style.display = 'block';
        sourceTag.innerText = source;
        sourceTag.style.display = 'block';
        sourceTag.style.background = source.includes('Wiki') ? 'rgba(0,0,0,0.6)' : 'rgba(255,165,0,0.8)';
    }

    function handleFallback() { if(currentItem) loadRandomImage(currentItem.en); }
    function forceRandomReload() { if(currentItem) openImageModal(currentItem, true); }
    function closeModal() { document.getElementById('imgModal').style.display = 'none'; }

    function stringToColor(str) {
        let hash = 0;
        for (let i = 0; i < str.length; i++) hash = str.charCodeAt(i) + ((hash << 5) - hash);
        const c = (hash & 0x00FFFFFF).toString(16).toUpperCase();
        return "00000".substring(0, 6 - c.length) + c;
    }
    function stringToPastelColor(str) {
        let hash = 0;
        for (let i = 0; i < str.length; i++) hash = str.charCodeAt(i) + ((hash << 5) - hash);
        const hue = hash % 360;
        return `hsl(${hue}, 70%, 90%)`; 
    }
    function stringToDarkerColor(str) {
        let hash = 0;
        for (let i = 0; i < str.length; i++) hash = str.charCodeAt(i) + ((hash << 5) - hash);
        const hue = hash % 360;
        return `hsl(${hue}, 60%, 40%)`; 
    }

    function speak(text, rate = 0.85) {
        window.speechSynthesis.cancel();
        const u = new SpeechSynthesisUtterance(text);
        u.lang = 'en-US';
        u.rate = rate; 
        window.speechSynthesis.speak(u);
    }

    function toggleQuiz() {
        isQuiz = !isQuiz;
        const btn = document.getElementById('btnQuiz');
        if (isQuiz) {
            btn.classList.add('active');
            document.getElementById('quizArea').style.display = 'block';
            nextQuestion();
        } else {
            btn.classList.remove('active');
            document.getElementById('quizArea').style.display = 'none';
        }
        if(isFocusMode) renderFocusCard();
    }

    function nextQuestion() {
        if (!activeItems || activeItems.length === 0) return;
        let newItem;
        do {
            newItem = activeItems[Math.floor(Math.random() * activeItems.length)];
        } while (activeItems.length > 1 && quizTarget && newItem.en === quizTarget.en);
        
        quizTarget = newItem;
        const qText = document.getElementById('quizQuestion');
        
        if (currentRoom.includes("ğŸ”¤")) {
             qText.innerText = `ğŸ‘‚ å“ªå€‹æ˜¯ "${quizTarget.en}" ?`;
             const hint = quizTarget.speak ? quizTarget.speak : quizTarget.en;
             speak(`Find ${hint}`);
        } else {
             qText.innerText = `ğŸ‘‚ Find: "${quizTarget.en}"`;
             speak(`Where is the ${quizTarget.en}?`);
        }
    }

    init();

</script>
</body>
</html>
